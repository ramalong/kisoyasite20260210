---
import site from "../../content/site.json";
import nav from "../../content/nav.json";

const email = site?.contact?.email ?? "";
const phones = Array.isArray(site?.contact?.phones) ? site.contact.phones : [];
const formUrl = site?.contact?.formUrl ?? "";

const instagram = site?.social?.instagram ?? "";
const facebook = site?.social?.facebook ?? "";

const year = new Date().getFullYear();
const copyrightName = site?.copyrightName ?? site?.siteName ?? "";
---

<footer class="footer" style="position: relative;">
  <div class="container footer-inner">
    <div class="footer-grid">
      <div>
        <div style="font-weight:700;">{site.siteName}</div>
        <div class="small" style="margin-top:8px;">{site.description}</div>

        <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
          {
            formUrl ? (
              <a
                class="btn primary"
                href={formUrl}
                target="_blank"
                rel="noopener noreferrer"
              >
                フォーム
              </a>
            ) : (
              <span class="badge">フォームURL未設定</span>
            )
          }
        </div>
      </div>

      <div>
        <div style="font-weight:700;">メニュー</div>
        <ul class="footer-links" style="margin-top:10px;">
          {
            nav.footer.map((i) => (
              <li>
                <a href={i.href}>{i.label}</a>
              </li>
            ))
          }
        </ul>
      </div>

      <div>
        <div style="font-weight:700;">連絡先</div>

        <div class="small" style="margin-top:10px;">
          Email:
          {
            email ? (
              <a href={`mailto:${email}`} style="text-decoration:underline;">
                {email}
              </a>
            ) : (
              "未設定"
            )
          }
        </div>

        <div class="small" style="margin-top:10px;">
          TEL:
          {
            phones.length ? (
              <ul style="margin:8px 0 0; padding-left:18px; display:flex; flex-direction:column; gap:6px;">
                {phones.map((p) => (
                  <li>
                    <span style="font-weight:600;">{p.label}：</span>
                    <a href={`tel:${p.tel}`} style="text-decoration:underline;">
                      {p.tel}
                    </a>
                  </li>
                ))}
              </ul>
            ) : (
              <span style="margin-left:6px;">未設定</span>
            )
          }
        </div>

        {
          (instagram || facebook) && (
            <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
              {instagram && (
                <a
                  class="btn"
                  href={instagram}
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  Instagram
                </a>
              )}
              {facebook && (
                <a
                  class="btn"
                  href={facebook}
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  Facebook
                </a>
              )}
            </div>
          )
        }
      </div>
    </div>

    <div class="small" style="margin-top:18px; opacity:.8;">
      © {year}
      {copyrightName}
    </div>
  </div>
</footer>

<style>
  .footer {
    background-color: var(--fg);
    color: var(--bg);
    border-top: 1px solid var(--line);
    z-index: 2; /* Ensure Footer is above WireframeBackground */
  }

  .footer a {
    color: var(--sub);
    text-decoration: none;
    transition: color 0.2s;
  }

  .footer a:hover {
    color: var(--accent);
  }

  .footer .small {
    color: var(--bg);
    opacity: 0.8;
  }

  .footer .btn {
    border: 1px solid var(--bg);
    color: var(--bg);
    background: transparent;
  }

  .footer .btn:hover {
    background: var(--bg);
    color: var(--fg);
  }

  .footer .btn.primary {
    background: var(--accent);
    color: var(--accent-ink);
    border-color: var(--accent);
  }

  .footer .btn.primary:hover {
    background: var(--surface);
    color: var(--accent);
  }
</style>
